<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Trading System - Live Signals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .signal-card {
            transition: all 0.3s ease;
        }
        .signal-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -4px rgba(0, 0, 0, 0.2);
        }
        .confidence-high { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .confidence-medium { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .confidence-low { background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); }
        
        .category-forex { border-left: 4px solid #3b82f6; }
        .category-metals { border-left: 4px solid #f59e0b; }
        .category-indices { border-left: 4px solid #8b5cf6; }
        .category-commodities { border-left: 4px solid #10b981; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen text-white">
    
    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">ðŸ¤– ML Trading System</h1>
                    <p class="text-slate-400 text-sm">AI-Powered Multi-Instrument Signals</p>
                </div>
                <div class="flex items-center gap-4">
                    <div class="text-right">
                        <div class="text-sm text-slate-400">System Status</div>
                        <div class="flex items-center gap-2">
                            <span class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></span>
                            <span class="font-semibold text-green-400">ONLINE</span>
                        </div>
                    </div>
                    <button onclick="refreshSignals()" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-semibold transition">
                        ðŸ”„ Refresh
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="text-slate-400 text-sm mb-2">Active Signals</div>
                <div id="stat-active" class="text-4xl font-bold text-blue-400">--</div>
            </div>
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="text-slate-400 text-sm mb-2">High Confidence</div>
                <div id="stat-high-conf" class="text-4xl font-bold text-green-400">--</div>
            </div>
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="text-slate-400 text-sm mb-2">Win Rate (24h)</div>
                <div id="stat-winrate" class="text-4xl font-bold text-purple-400">--</div>
            </div>
            <div class="bg-slate-800 rounded-lg p-6 border border-slate-700">
                <div class="text-slate-400 text-sm mb-2">Instruments</div>
                <div id="stat-instruments" class="text-4xl font-bold text-orange-400">--</div>
            </div>
        </div>

        <!-- Filters -->
        <div class="bg-slate-800 rounded-lg p-6 border border-slate-700 mb-8">
            <div class="flex flex-wrap gap-4">
                <div class="flex-1 min-w-[200px]">
                    <label class="block text-sm font-semibold text-slate-300 mb-2">Category</label>
                    <select id="filter-category" onchange="filterSignals()" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white">
                        <option value="all">All Categories</option>
                        <option value="forex">Forex</option>
                        <option value="metals">Metals</option>
                        <option value="indices">Indices</option>
                        <option value="commodities">Commodities</option>
                    </select>
                </div>
                <div class="flex-1 min-w-[200px]">
                    <label class="block text-sm font-semibold text-slate-300 mb-2">Confidence</label>
                    <select id="filter-confidence" onchange="filterSignals()" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white">
                        <option value="all">All Levels</option>
                        <option value="high">High (â‰¥90%)</option>
                        <option value="medium">Medium (75-90%)</option>
                    </select>
                </div>
                <div class="flex-1 min-w-[200px]">
                    <label class="block text-sm font-semibold text-slate-300 mb-2">Search</label>
                    <input type="text" id="filter-search" onkeyup="filterSignals()" placeholder="Search symbol..." class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400">
                </div>
            </div>
        </div>

        <!-- Signals Grid -->
        <div id="signals-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Signals will be dynamically loaded here -->
        </div>

        <!-- Loading State -->
        <div id="loading-state" class="text-center py-20">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mb-4"></div>
            <p class="text-slate-400 text-lg">Loading signals...</p>
        </div>

        <!-- No Signals State -->
        <div id="no-signals-state" class="text-center py-20 hidden">
            <div class="text-6xl mb-4">ðŸ“Š</div>
            <p class="text-slate-400 text-lg">No signals match your filters</p>
        </div>

    </div>

    <script>
        // Mock data for demonstration - In production, this would fetch from backend API
        const mockSignals = [
            {
                symbol: 'EUR_USD',
                display_name: 'EUR/USD',
                category: 'forex',
                direction: 'BUY',
                entry: 1.10500,
                stop_loss: 1.10000,
                take_profit: 1.11500,
                confidence: 0.92,
                models: { lstm: 0.94, svm: 0.88, rf: 0.93 },
                timestamp: new Date().toISOString(),
                pip_distance: 50,
                rr_ratio: 2.0
            },
            {
                symbol: 'XAU_USD',
                display_name: 'Gold',
                category: 'metals',
                direction: 'SELL',
                entry: 2050.50,
                stop_loss: 2080.00,
                take_profit: 2020.00,
                confidence: 0.88,
                models: { lstm: 0.91, svm: 0.84, rf: 0.89 },
                timestamp: new Date().toISOString(),
                pip_distance: 2950,
                rr_ratio: 1.03
            },
            {
                symbol: 'SPX500_USD',
                display_name: 'S&P 500',
                category: 'indices',
                direction: 'BUY',
                entry: 4850.0,
                stop_loss: 4800.0,
                take_profit: 4950.0,
                confidence: 0.78,
                models: { lstm: 0.82, svm: 0.75, rf: 0.77 },
                timestamp: new Date().toISOString(),
                pip_distance: 50,
                rr_ratio: 2.0
            },
            {
                symbol: 'GBP_USD',
                display_name: 'GBP/USD',
                category: 'forex',
                direction: 'SELL',
                entry: 1.27500,
                stop_loss: 1.28000,
                take_profit: 1.26500,
                confidence: 0.91,
                models: { lstm: 0.93, svm: 0.90, rf: 0.90 },
                timestamp: new Date().toISOString(),
                pip_distance: 50,
                rr_ratio: 2.0
            },
            {
                symbol: 'USD_JPY',
                display_name: 'USD/JPY',
                category: 'forex',
                direction: 'BUY',
                entry: 145.500,
                stop_loss: 145.000,
                take_profit: 146.500,
                confidence: 0.85,
                models: { lstm: 0.87, svm: 0.83, rf: 0.85 },
                timestamp: new Date().toISOString(),
                pip_distance: 50,
                rr_ratio: 2.0
            },
            {
                symbol: 'NAS100_USD',
                display_name: 'NASDAQ 100',
                category: 'indices',
                direction: 'BUY',
                entry: 17500.0,
                stop_loss: 17400.0,
                take_profit: 17700.0,
                confidence: 0.76,
                models: { lstm: 0.79, svm: 0.74, rf: 0.75 },
                timestamp: new Date().toISOString(),
                pip_distance: 100,
                rr_ratio: 2.0
            }
        ];

        let allSignals = [];
        let filteredSignals = [];

        // Initialize
        function init() {
            loadSignals();
            updateStats();
            setInterval(refreshSignals, 60000); // Refresh every minute
        }

        // Load signals
        function loadSignals() {
            // In production, fetch from API: fetch('/api/signals')
            allSignals = mockSignals;
            filteredSignals = allSignals;
            renderSignals();
            document.getElementById('loading-state').classList.add('hidden');
        }

        // Render signals
        function renderSignals() {
            const container = document.getElementById('signals-container');
            
            if (filteredSignals.length === 0) {
                container.innerHTML = '';
                document.getElementById('no-signals-state').classList.remove('hidden');
                return;
            }
            
            document.getElementById('no-signals-state').classList.add('hidden');
            
            container.innerHTML = filteredSignals.map(signal => createSignalCard(signal)).join('');
        }

        // Create signal card HTML
        function createSignalCard(signal) {
            const confidenceLevel = signal.confidence >= 0.90 ? 'high' : signal.confidence >= 0.75 ? 'medium' : 'low';
            const confidenceColor = confidenceLevel === 'high' ? 'green' : confidenceLevel === 'medium' ? 'yellow' : 'gray';
            const directionColor = signal.direction === 'BUY' ? 'green' : 'red';
            
            return `
                <div class="signal-card category-${signal.category} bg-slate-800 rounded-lg p-6 border border-slate-700">
                    <!-- Header -->
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-bold text-white">${signal.display_name}</h3>
                            <p class="text-sm text-slate-400">${signal.symbol}</p>
                        </div>
                        <div class="confidence-${confidenceLevel} text-white font-bold px-4 py-2 rounded-lg text-center min-w-[80px]">
                            <div class="text-2xl">${(signal.confidence * 100).toFixed(0)}%</div>
                            <div class="text-xs uppercase">${confidenceLevel}</div>
                        </div>
                    </div>

                    <!-- Direction & Entry -->
                    <div class="mb-4 bg-slate-700 rounded-lg p-4">
                        <div class="flex justify-between items-center">
                            <span class="text-${directionColor}-400 font-bold text-xl">${signal.direction}</span>
                            <span class="text-white font-mono text-xl">${signal.entry.toFixed(signal.category === 'indices' ? 1 : 5)}</span>
                        </div>
                    </div>

                    <!-- Levels -->
                    <div class="space-y-2 mb-4">
                        <div class="flex justify-between">
                            <span class="text-slate-400">Stop Loss:</span>
                            <span class="text-red-400 font-semibold">${signal.stop_loss.toFixed(signal.category === 'indices' ? 1 : 5)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-400">Take Profit:</span>
                            <span class="text-green-400 font-semibold">${signal.take_profit.toFixed(signal.category === 'indices' ? 1 : 5)}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-400">R:R Ratio:</span>
                            <span class="text-blue-400 font-semibold">1:${signal.rr_ratio.toFixed(2)}</span>
                        </div>
                    </div>

                    <!-- Model Breakdown -->
                    <div class="border-t border-slate-700 pt-4">
                        <div class="text-xs text-slate-400 mb-2">Model Confidence:</div>
                        <div class="grid grid-cols-3 gap-2 text-xs">
                            <div class="text-center">
                                <div class="text-slate-400">LSTM</div>
                                <div class="text-white font-semibold">${(signal.models.lstm * 100).toFixed(0)}%</div>
                            </div>
                            <div class="text-center">
                                <div class="text-slate-400">SVM</div>
                                <div class="text-white font-semibold">${(signal.models.svm * 100).toFixed(0)}%</div>
                            </div>
                            <div class="text-center">
                                <div class="text-slate-400">RF</div>
                                <div class="text-white font-semibold">${(signal.models.rf * 100).toFixed(0)}%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Timestamp -->
                    <div class="text-xs text-slate-500 mt-4 text-center">
                        ${new Date(signal.timestamp).toLocaleString()}
                    </div>
                </div>
            `;
        }

        // Filter signals
        function filterSignals() {
            const category = document.getElementById('filter-category').value;
            const confidence = document.getElementById('filter-confidence').value;
            const search = document.getElementById('filter-search').value.toLowerCase();

            filteredSignals = allSignals.filter(signal => {
                // Category filter
                if (category !== 'all' && !signal.category.includes(category)) {
                    return false;
                }

                // Confidence filter
                if (confidence === 'high' && signal.confidence < 0.90) return false;
                if (confidence === 'medium' && (signal.confidence < 0.75 || signal.confidence >= 0.90)) return false;

                // Search filter
                if (search && !signal.symbol.toLowerCase().includes(search) && 
                    !signal.display_name.toLowerCase().includes(search)) {
                    return false;
                }

                return true;
            });

            renderSignals();
            updateStats();
        }

        // Update stats
        function updateStats() {
            const highConf = filteredSignals.filter(s => s.confidence >= 0.90).length;
            const uniqueInstruments = new Set(filteredSignals.map(s => s.symbol)).size;
            
            document.getElementById('stat-active').textContent = filteredSignals.length;
            document.getElementById('stat-high-conf').textContent = highConf;
            document.getElementById('stat-winrate').textContent = '54%'; // Mock data
            document.getElementById('stat-instruments').textContent = uniqueInstruments;
        }

        // Refresh signals
        function refreshSignals() {
            console.log('Refreshing signals...');
            // In production: fetch fresh data from API
            loadSignals();
        }

        // Initialize on page load
        window.onload = init;
    </script>

</body>
</html>
